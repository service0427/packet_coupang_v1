# 100회 크롤링 안정성 테스트 결과

## 테스트 결과 요약

### 성공 구간
- **1-16회**: 100% 성공 (16/16)
- **성공 패턴**: chrome120 HTTP/2 오류 → chrome124 자동 폴백 ✅

### 실패 구간
- **17회 이후**: 연속 실패
- **실패 원인**: chrome120, chrome124 모두 HTTP/2 INTERNAL_ERROR
- **쿠키 갱신 후 재시도**: 여전히 실패

## 핵심 발견

### 1. 패킷 레벨 우회 부분 성공
```
기존 방식: 0-1회 성공 → 즉시 차단
현재 방식: 16회 연속 성공 → 패턴 감지 후 차단

개선율: 1600% (16배 향상)
```

### 2. Akamai 차단 메커니즘
- **단기 성공**: Playwright 쿠키 + curl-cffi로 초기 우회 가능
- **중기 차단**: 약 15-20회 요청 후 TLS 지문 패턴 감지
- **재시도 실패**: 동일 지문으로는 쿠키 갱신해도 차단 지속

### 3. TLS 지문 이슈
- curl-cffi는 **고정된 impersonate 프로필** 사용
- chrome120, chrome124 각각 **고유한 TLS 지문**
- Akamai가 **반복 패턴** 감지 → 차단

## 문제 분석

### 차단 원인
1. **동일한 TLS ClientHello 반복**
   - BoringSSL + 고정 Cipher Suites
   - 동일한 HTTP/2 SETTINGS 프레임

2. **패턴 기반 탐지**
   - 15-20회 동일 패턴 반복 시 차단
   - IP + TLS 지문 조합으로 추적

3. **쿠키만으로 부족**
   - 쿠키 갱신해도 TLS 지문은 동일
   - 다층 방어 시스템 (쿠키 + TLS + 행동 패턴)

## 개선 방안

### 단기 해결책 (현재 적용 가능)
1. **프로필 회전**
   - chrome120, chrome124, edge99, edge101 순환
   - 매 요청마다 다른 프로필 사용

2. **쿠키 갱신 주기 단축**
   - 현재: 50회마다
   - 개선: 10-15회마다

3. **딜레이 증가**
   - 현재: 2-4초
   - 개선: 5-10초 (더 자연스러운 패턴)

### 중기 해결책 (추가 개발 필요)
1. **HTTP/2 SETTINGS 랜덤화**
   - 매 요청마다 다른 SETTINGS 값
   - Wireshark 분석한 범위 내에서 변경

2. **세션 재생성**
   - 일정 횟수마다 Playwright 재시작
   - 완전히 새로운 쿠키 + 지문 조합

### 장기 해결책 (근본 해결)
1. **커스텀 TLS 라이브러리**
   - BoringSSL 직접 수정
   - 매 요청마다 다른 ClientHello 생성

2. **프록시 회전**
   - IP 주소 변경
   - TLS 지문 + IP 조합 다양화

## 결론

### 달성한 것
✅ 패킷 레벨 우회 기술 확립
✅ Playwright + curl-cffi 조합 성공
✅ 16회 연속 크롤링 성공 (기존 대비 16배 개선)

### 해결해야 할 것
❌ TLS 지문 패턴 차단 (15-20회 후)
❌ 장기 안정적 크롤링 (100회+)
❌ 자동 복구 메커니즘

### 최종 평가
```
현재 상태: 부분 성공 (16회)
목표 상태: 완전 성공 (100회+)
진행률: 약 16%
```

**권장 사항**: 프로필 회전 + 딜레이 증가 → 예상 30-40회 성공
